scroll = 0
current_bank = 0
start main interrupt on raster line 1
loop

main interrupt:
	scroll = scroll -2;
	scrollx(scroll)
	write()
	if scroll = 1 then copyhalfscreen(0)     // Bottom half to top, current screen to buffer
	if scroll = 3 then copyhalfscreen(1)	 //Top half to bottom, current screen to buffer	
	if scroll = 7 then switchbanks()
	
	
write:
	if current_bank = 0 then
		screen = $0400
	else
		screen = $4400
	endif
	
	moveto 0, 4 on screen   // row, col
		
	print space at column 39
	move to 0, 5 on screen
	
	if scroll < 0    // scroll > = 127 because sign bit for bytes
	
		draw colum 39 on current screen
		scroll = 7
		
	endif	
	
copyhalfscreen(ul):

	// First screen to second
	if current_bank = 0 then
		if ul = 0 then
			copy bytes from $0400 + 520 to $4400 + 520 - 1, 9 lines, inverted y range 
		else
			copy bytes from $0400 to $4400 - 1, 13 lines, inverted y range
	endif

	// second screen to first
	if current_bank = 1 then
		if ul = 0 then
			copy bytes from $0=4400 + 520 to $0400 + 520 - 1, 9 lines, inverted y range 
		else
			copy bytes from $4400 to $0400 - 1, 13 lines, inverted y range
	endif		
	
switchbanks:
	// The screen is either at $0400 or $4400. The VIC II can only address memory
	// in 16KB chunks so to display the screen when it's at $0400 VIC Bank 0 must be
	// selected. Similarly, VIC bank 1 when the screen is at $4400
	
	if current_bank is 0 then
		set vic bank to 1
		set current_bank to 1
	else
		set vic bank to 0
		set current_bank to 0
	endif
	
	